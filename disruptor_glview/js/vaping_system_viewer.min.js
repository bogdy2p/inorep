var _InnokinDisrupterViewer=function(){function e(e){var t=L.domElement.getBoundingClientRect();return"touchend"==e.type?vt:(e.touches?(vt.x=2*((e.touches[0].clientX-t.left)/L.domElement.width)-1,vt.y=1-2*((e.touches[0].clientY-t.top)/L.domElement.height)):(vt.x=2*((e.clientX-t.left)/L.domElement.width)-1,vt.y=1-2*((e.clientY-t.top)/L.domElement.height)),vt)}function t(e){if(nt){var t=parseInt(e.target.getAttribute("data-step"));isNaN(t)||t!=ut&&x(t)}return e.preventDefault&&e.preventDefault(),!1}function o(e){var t=e.target.getAttribute("data-action");switch(t){case"zoom-full":j();break;case"zoom-oled":D();break;case"change-mod-color":var o=parseInt(e.target.getAttribute("data-coloridx"),10);if(!isNaN(o)){var n,a=_t[1].clones[o].getObjectByName("mod_shell");a.traverse(function(e){e instanceof THREE.Mesh&&(n=e.material)}),a=et.disrupter.getObjectByName("mod_shell"),a.traverse(function(e){e instanceof THREE.Mesh&&(e.material=n)}),tt.disrupter=_t[1].clones[o]}break;case"change-cell-color":var o=parseInt(e.target.getAttribute("data-coloridx"),10);if(!isNaN(o)){var n,a=_t[2].clones[o].getObjectByName("battery_shell");a.traverse(function(e){e instanceof THREE.Mesh&&(n=e.material)}),a=et.innocell.getObjectByName("battery_shell"),a.traverse(function(e){e instanceof THREE.Mesh&&(e.material=n)}),tt.innocell=_t[2].clones[o]}}return e.preventDefault&&e.preventDefault(),!1}function n(t){switch(t.type){case"mousedown":case"touchstart":case"pointerdown":e(t);var o=a(),n=15;if(o){for(;!(o.parent instanceof THREE.Group);)o=o.parent;var i=nt?4:ut+1;switch(ut){case 1:if("disrupter"==o.name)if(o.position.y==n){tt.disrupter=o;var r,l=o.getObjectByName("mod_shell");l.traverse(function(e){e instanceof THREE.Mesh&&(r=e.material)}),et.disrupter.getObjectByName("mod_shell").traverse(function(e){e instanceof THREE.Mesh&&(e.material=r)}),x(i)}else ot&&"disrupter"==ot.name&&Wt.popout_object(ot,0),Wt.popout_object(o,n),ot=o;break;case 2:if("innocell"==o.name)if(o.position.y==n+21){tt.innocell=o;var r,l=o.getObjectByName("battery_shell");l.traverse(function(e){e instanceof THREE.Mesh&&(r=e.material)}),et.innocell.getObjectByName("battery_shell").traverse(function(e){e instanceof THREE.Mesh&&(e.material=r)}),x(i)}else ot&&"innocell"==ot.name&&Wt.popout_object(ot,21),Wt.popout_object(o,n+21),ot=o;break;case 3:"isub_coil02ohm"==o.name&&(o.position.y==n?(tt.coil=o,Dt.ohmz=10*o.userData.ohms,"ON"===jt&&W(),nt=!0,x(i)):(ot&&"isub_coil02ohm"==ot.name&&Wt.popout_object(ot,0),Wt.popout_object(o,n),ot=o));break;case 4:switch(o.name){case"startbutton":console.log("BIGBUTTONPRESS"),"OFF"==jt?S():C();break;case"up_button":console.log("UPBUTTON"),P();break;case"down_button":console.log("DOWNBUTTON"),M()}}}break;case"mouseup":case"touchend":case"pointerup":z()}return!1}function a(){if($.length){q.setFromCamera(vt,B);var e=q.intersectObjects(X,!0);if(e.length)return e[0].object}return!1}function i(){requestAnimationFrame(i),r(U.getDelta()),TWEEN.update()}function r(e){Y.position.x=B.position.x,Y.position.y=B.position.y,Y.position.z=B.position.z,TWEEN.update(),G&&G.tick(e),L.render(I,B)}function l(e){if(!e)return Et.container=Et.container?Et.container:document.body,!1;if(e.width=parseInt(e.width),e.height=parseInt(e.height),Et.width=isNaN(e.width)?Et.width:e.width,Et.height=isNaN(e.height)?Et.height:e.height,e.containerId){var t=document.getElementById(e.containerId);t&&(Et.container=t)}else Et.container=Et.container?Et.container:document.body}function s(){for(var e in gt)for(et[e]=new THREE.Group,et[e].name=e,et[e].visible=!1,I.add(et[e]),at+=gt[e].length,it+=gt[e].length;gt[e].length;){var t=gt[e].shift();c(t,e)}}function c(e,t){var o;switch(e.type){case"collada":o=THREE.ColladaLoader;break;case"obj":o=THREE.OBJLoader}var n=new o;"collada"==e.type&&(n.options.convertUpAxis=!0),n.load(rt+e.model,function(o){var n=o.scene?o.scene:o;if(et[t].add(n),at-=1,e.material){var a=new THREE.MeshPhongMaterial(e.material);n.traverse(function(e){e instanceof THREE.Mesh&&(e.material=a)})}if("olcd"===e.name){var a=new THREE.MeshPhongMaterial(e.material);n.traverse(function(e){e instanceof THREE.Mesh&&(e.material=a)})}["startbutton","up_button","down_button"].indexOf(e.name)>-1&&$.push(n.children[0]),e.name&&(n.name=e.name),u(),at||f()})}function p(){if(Q=document.getElementById("WebglLoadingOverlay"),!Q){Q=document.createElement("div"),Q.className="loading-overlay",Q.id="WebglLoadingOverlay";var e=document.createElement("div");e.className="progress-bar";var t=document.createElement("div");t.className="progress-indicator",t.id="progress-indicator",t.style.width="0",e.appendChild(t),Q.appendChild(e),xt.wrapper.appendChild(Q)}}function m(){Q=document.getElementById("WebglLoadingOverlay"),Q&&Q.parentNode.removeChild(Q)}function u(){var e=document.getElementById("progress-indicator"),t=1-at/it;e?e.style.width=100*t+"%":console.log(100*t)}function d(){if(L){xt.wrapper=document.createElement("div"),xt.wrapper.className="disrupter-view-wrapper",L.domElement.className="disrupter-view-canvas",L.domElement.parentNode.appendChild(xt.wrapper),xt.wrapper.appendChild(L.domElement),xt.wrapper.style.width=L.domElement.width+"px",xt.title=document.createElement("h4"),xt.title.className="step-title",xt.title.id="WebGlViewerTitle",xt.title.innerHTML=_t[ut].title,xt.wrapper.appendChild(xt.title);var e=document.createElement("span");e.className="step-button-holder",xt.wrapper.appendChild(e);var n=document.createElement("span");n.className="inner-holder",e.appendChild(n);for(var a=["mousedown","pointerdown","touchstart"],i=1;4>=i;i++){var r=document.createElement("span");r.className="step-button",r.setAttribute("data-step",i),r.innerHTML=_t[i].icon?"&nbsp;":'<span class="step-no">'+i+".</span> "+_t[i].title,r.className+=_t[i].icon?" "+_t[i].icon:"",n.appendChild(r),bt.push(r);for(var l=0;l<a.length;l++)r.addEventListener(a[l],t)}for(var s=["zoom-full","zoom-oled"],c=0;c<s.length;c++){var m=document.createElement("span");m.className="step4-tool-button "+s[c],m.setAttribute("data-action",s[c]),m.innerHTML="&nbsp;",xt.wrapper.appendChild(m);for(var l=0;l<a.length;l++)m.addEventListener(a[l],o);ht.push(m)}var u=document.createElement("span");u.className="viewer-color-swatches",u.id="InnokinModSwatches";var d=document.createElement("span");d.className="part-title",d.innerHTML="Disrupter:",u.style.right="30px",u.appendChild(d);for(var E=0;E<yt.length;E++){var b=document.createElement("span");b.className="color-swatch",b.style.backgroundColor="#"+(16777216|yt[E].color).toString(16).substring(1),b.setAttribute("data-action","change-mod-color"),b.setAttribute("data-coloridx",E),b.innerHTML="&nbsp;",u.appendChild(b);for(var l=0;l<a.length;l++)b.addEventListener(a[l],o)}ht.push(u),xt.wrapper.appendChild(u);var u=document.createElement("span");u.className="viewer-color-swatches",u.id="InnokinCellSwatches";var d=document.createElement("span");d.className="part-title",d.innerHTML="InnokinCell:",u.style.left="30px",u.appendChild(d);for(var E=0;E<Tt.length;E++){var b=document.createElement("span");b.className="color-swatch",b.style.backgroundColor="#"+(16777216|Tt[E].color).toString(16).substring(1),b.setAttribute("data-action","change-cell-color"),b.setAttribute("data-coloridx",E),b.innerHTML="&nbsp;",u.appendChild(b);for(var l=0;l<a.length;l++)b.addEventListener(a[l],o)}xt.wrapper.appendChild(u),ht.push(u),p()}}function E(){et.isub_coil02ohm.rotation.set(0,0,0),et.isub_coil02ohm.position.set(-22.5,0,-3.5),et.disrupter.rotation.set(0,0,0),et.disrupter.position.set(0,0,0),et.innocell.rotation.set(0,0,0),et.innocell.position.set(-29.95,0,0)}function b(){for(var e in et)et[e].visible=!1;for(var t in _t)if(_t[t].clones)for(var o=0;o<_t[t].clones.length;o++)_t[t].clones[o].visible=!1}function h(){if(!_t[1].clones.length){et.step1=new THREE.Group,et.step1.name="step1",I.add(et.step1);for(var e=0,t=0;t<yt.length;t++){var o=et.disrupter.clone();et.step1.add(o);var n=t%2?1:-1;e+=60*t*n,o.position.set(e+15,0,0),o.rotation.set(0,Math.PI/4,0);var a=o.getObjectByName("mod_shell");if(a){var i=t%yt.length,r=new THREE.MeshPhongMaterial(yt[i]);a.traverse(function(e){e instanceof THREE.Mesh&&(e.material=r)})}o.visible=!1,_t[1].clones.push(o)}tt.disrupter=_t[1].clones[0]}}function w(){if(!_t[2].clones.length){for(var e=Math.PI/4,t=[[32.5,21,4],[26,21,-21],[4,21,-32],[-20,21,-25],[-32,21,-4],[-25,21,20],[-4,21,32],[20.5,21,26]],o=0;8>o;o++){var n=et.innocell.clone();et.tabletop.add(n),n.rotation.y=e*o,n.position.set(t[o][0],t[o][1],t[o][2]);var a=n.getObjectByName("battery_shell");if(a){var i=o%Tt.length,r=new THREE.MeshPhongMaterial(Tt[i]);a.traverse(function(e){e instanceof THREE.Mesh&&(e.material=r)})}n.visible=!1,_t[2].clones.push(n)}tt.innocell=_t[2].clones[0]}}function y(e){var t=new THREE.TextGeometry(e,{size:10,height:2,curveSegments:4,font:"droid sans",weight:"normal",style:"normal",bevelThickness:1,bevelSize:1,bevelEnabled:!1,material:0,extrudeMaterial:1});t.computeBoundingBox(),material=new THREE.MeshPhongMaterial({color:11778499,shininess:30,specular:14605286,metal:!0,shading:THREE.FlatShading});var o=-.5*(t.boundingBox.max.x-t.boundingBox.min.x),n=new THREE.Mesh(t,material);return n.position.x=o,n.position.y=60,n.position.z=0,n.rotation.x=0,n.rotation.y=0,group=new THREE.Group,group.add(n),group}function T(){if(!_t[3].clones.length){et.step3=new THREE.Group,et.step3.name="step3",I.add(et.step3);for(var e=0,t=0;t<ft.length;t++){var o=et.isub_coil02ohm.clone();et.step3.add(o);var n=t%2?1:-1;o.userData.ohms=ft[t],e+=100*t*n;var a=o.position.x;o.position.set(a+e-25,0,0),o.rotation.set(0,0,0);var i=y(ft[t]+" Î©");o.add(i),o.visible=!1,_t[3].clones.push(o)}tt.coil=_t[3].clones[0]}}function g(){if(Z)K.minPolarAngle=0,K.maxPolarAngle=Math.PI,K.noPan=!1;else switch(K.enabled=!0,K.minAzimuthAngle=-1/0,K.maxAzimuthAngle=1/0,K.minPolarAngle=Math.PI/3,K.maxPolarAngle=Math.PI/2,ut){case 1:K.minAzimuthAngle=-Math.PI/10,K.maxAzimuthAngle=Math.PI/10;break;case 2:K.minPolarAngle=1.25,K.maxPolarAngle=1.25,K.update();break;case 3:K.minAzimuthAngle=-Math.PI/20,K.maxAzimuthAngle=Math.PI/20,B.position.set(2.13455,178.7043,281.966),B.rotation.set(-.39847,.006977,.00293723),K.center.set(0,60,0),K.update();break;case 4:B.position.set(7.4252,84.2356,163.364),B.rotation.set(-.1473,.04493,.00666),K.center.set(0,60,0),K.maxPolarAngle=Math.PI,K.minPolarAngle=0,K.update(),K.enabled=!1}}function v(e){if(dt=ut,e=parseInt(e),e=isNaN(e)||e>4?ut:e,ut!=e){switch(ut=e,b(),g(),ut){case 1:et.step1.visible=!0;for(var t=0;t<_t[ut].clones.length;t++)_t[ut].clones[t].visible=!0;X=_t[ut].clones;break;case 2:et.tabletop.visible=!0;for(var t=0;t<_t[ut].clones.length;t++)_t[ut].clones[t].visible=!0;X=et.tabletop.children;break;case 3:et.step3.visible=!0;for(var t=0;t<_t[ut].clones.length;t++)_t[ut].clones[t].visible=!0;X=_t[ut].clones;break;case 4:et.innocell.position.y=0,et.isub_coil02ohm.position.y=0,et.disrupter.position.y=0,et.innocell.visible=!0,et.disrupter.visible=!0,et.isub_coil02ohm.visible=!0,X=$}for(var o=0;o<bt.length;o++)bt[o].className=bt[o].className.replace(/active/g," ").replace(/\s+/," ");bt[ut-1].className+=" active",document.getElementById("WebGlViewerTitle").innerHTML=_t[ut].title;for(var o=0;o<ht.length;o++)ht[o].style.display=4==ut?"block":"none"}}function f(){E(),I.remove(et.disrupter,et.innocell,et.isub_coil02ohm),J=new THREE.Group,J.add(et.disrupter),J.add(et.innocell),J.add(et.isub_coil02ohm),I.add(J),b(),h(),w(),T(),et.tabletop.position.set(0,-21,0),m();var e=ut;ut=0,v(e),Wt.step[ut]["in"](),console.log(tt),console.clear()}function _(){if(Z){K.minPolarAngle=0,K.maxPolarAngle=Math.PI,K.noPan=!1,B.far=1e3,I.traverse(function(e){e instanceof THREE.DirectionalLight&&I.add(new THREE.DirectionalLightHelper(e,20))});var e=new THREE.GridHelper(300,10);I.add(e);var t=new THREE.AxisHelper(20);I.add(t)}}function x(e){TWEEN.removeAll(),Wt.step[ut]?Wt.step[ut].out(function(){v(e),Wt.step[ut]["in"]()}):v(e)}function D(){4==ut&&(TWEEN.removeAll(),B.position.set(7.4252,84.2356,163.364),B.rotation.set(-.1473,.04493,.00666),K.center.set(0,60,0),E(),Wt.zoom_to_oled_new(),K.enabled=Z?!0:!1)}function j(){4==ut&&(TWEEN.removeAll(),E(),Wt.zoom_to_fullview(),K.enabled=!0,K.minAzimuthAngle=-1/0,K.maxAzimuthAngle=1/0,K.minPolarAngle=0,K.maxPolarAngle=Math.PI)}function N(e){j(),filter=I.getObjectByName("isub_coil02ohm"),complete_device_group=filter.parent,Ct||(G=new SPE.Group({texture:THREE.ImageUtils.loadTexture(rt+"texture/smokeparticle.png"),maxAge:5,hasPerspective:!0,colorize:!0}),V=new SPE.Emitter({position:new THREE.Vector3(-22,152,-4),positionSpread:new THREE.Vector3(0,0,0),acceleration:new THREE.Vector3(0,10,0),accelerationSpread:new THREE.Vector3(0,0,0),velocity:new THREE.Vector3(0,0,0),velocitySpread:new THREE.Vector3(10,0,10),colorStart:new THREE.Color(16777215),colorEnd:new THREE.Color(16777215),sizeStart:5,sizeEnd:150,particleCount:3*e/10}),G.addEmitter(V),complete_device_group.add(G.mesh),Ct=!0,O())}function H(){Ct&&(filter=I.getObjectByName("isub_coil02ohm"),complete_device_group=filter.parent,complete_device_group.remove(G.mesh),Ct=!1)}function R(e,t){switch(F(t),t){case"watt":e.drawText(ohmz_ammount_display+"Î©",11,90,"#FDFDFD","51.2px DisrupterLCDFont"),e.drawText(volt_ammount_display+"v",11,150,"#FDFDFD","51.2px DisrupterLCDFont"),e.drawText(watt_ammount_display,155,130,"#FDFDFD","76.8px DisrupterLCDFont"),e.drawText("w",285,130,"#FDFDFD","76.8px DisrupterLCDFont"),e.drawText("î",345,120,"#FFFFFF","76.8px DisrupterLCDFont");break;case"volt":e.drawText(ohmz_ammount_display+"Î©",10,90,"#FDFDFD","51.2px DisrupterLCDFont"),e.drawText(watt_ammount_display+"w",12,150,"#FDFDFD","51.2px DisrupterLCDFont"),e.drawText(volt_ammount_display,150,130,"#FDFDFD","76.8px DisrupterLCDFont"),e.drawText("v",289,130,"#FDFDFD","76.8px DisrupterLCDFont"),e.drawText("î",345,120,"#FFFFFF","76.8px DisrupterLCDFont")}}function F(){var e=(Dt.volt/10).toString(),t=(Dt.watt/10).toString(),o=(Dt.ohmz/10).toString();volt_ammount_display=e,watt_ammount_display=t,ohmz_ammount_display=o,Dt.volt%10==0&&(volt_ammount_display+=".0"),volt_ammount_display+="0",watt_ammount_display=Dt.watt%10==5?t:t+".0",Dt.watt<100&&(watt_ammount_display=" "+watt_ammount_display),ohmz_ammount_display+=Dt.ohmz%10==0?".00":"0"}function S(){var e=I.getObjectByName("startbutton"),t=0,o=0;e.position.x+=.5,Ht+=1,Rt+=1,"OFF"===jt&&(startButtonPushStart=U.elapsedTime,startButtonPushed=!0,Ht%3==1&&(clearTimeout(),startClick1=U.elapsedTime,timer_running=!0,setTimeout(function(){timer_running&&InnokinDisrupterViewer.displayStartInformation()},400)),Ht%3==2&&(clearTimeout(),startClick2=U.elapsedTime,t=startClick2-startClick1,timer_running=!1),Ht%3==0&&(clearTimeout(),startClick3=U.elapsedTime,o=startClick3-startClick1,timer_running=!1,InnokinDisrupterViewer.startDisruptorWithLogo(),jt="ON")),setTimeout(function(){timer_running=!0,Ht=0},600)}function C(){Ct?St=setTimeout(function(){complete_device_group=I.getObjectByName("disrupter").parent,complete_device_group.remove(G.mesh),Ct=!1},Mt):Ft=setTimeout(function(){N(Dt.watt)},Mt)}function M(){var e=I.getObjectByName("down_button");if(e.position.x+=.3,"ON"===jt)switch(Nt){case"volt":Dt.volt<74.1?Dt.volt+=1:Dt.volt=30,Dt.volt.toFixed(2),W();break;case"watt":Dt.watt<496?Dt.watt+=5:Dt.watt=60,W(),clearTimeout(Pt),Pt=setTimeout(function(){k()},500),O()}}function P(){var e=I.getObjectByName("up_button");if(e.position.x+=.3,"ON"===jt)switch(Nt){case"volt":console.log("volt"),Dt.volt>31?Dt.volt-=1:Dt.volt=75,W();break;case"watt":console.log("watt"),Dt.watt>64?Dt.watt-=5:Dt.watt=500,W(),clearTimeout(Pt),Pt=setTimeout(function(){k()},500),O()}}function z(){var e=I.getObjectByName("startbutton"),t=I.getObjectByName("up_button"),o=I.getObjectByName("down_button");e.position.x=0,t.position.x=0,o.position.x=0,startButtonPushed=!1,clearTimeout(Ft),clearTimeout(St)}function W(){var e=I.getObjectByName("smallScreen"),t=new THREEx.DynamicTexture(400,200);t.name="screenDynamicTexture",t.texture.needsUpdate=!0,t.clear("#667788"),R(t,Nt);var o=new THREE.MeshBasicMaterial({map:t.texture});e.material=o}function k(){Ct&&(Ct=!1,complete_device_group=I.getObjectByName("disrupter").parent,complete_device_group.remove(G.mesh),N(Dt.watt))}function A(){tempDynamicTexture=new THREEx.DynamicTexture(10,10),tempGeometry=new THREE.PlaneBufferGeometry(45,20,30,30),tempMaterial=new THREE.MeshBasicMaterial({map:tempDynamicTexture.texture}),tempPlane=new THREE.Mesh(tempGeometry,tempMaterial),tempPlane.name="tempScreenFarAway",tempPlane.position.z=5e3,tempPlane.position.x=5e3,tempPlane.position.y=5e3,I.add(tempPlane),tempDynamicTexture.drawTextCooked({text:"SomeRandoMText",align:"center",lineHeight:.3,fillStyle:"#FDFDFD",font:"38px DisrupterLCDFont",family:"DisrupterLCDFont"}),setTimeout(function(){I.remove(tempPlane)},2e3)}function O(){console.log("reset15sectimeout called"),clearTimeout(zt),zt=setTimeout(function(){H(),console.log("reset15secTimeout STOPSMOKING")},15e3)}var I,B,L,G,V,U,q,Y,K,X,J,Q,Z=!1,$=[],et={},tt={disrupter:null,innocell:null,coil:null},ot=null,nt=Z,at=0,it=0,rt="./disruptor_glview/resources/",lt={slide_in:{src:["sounds/disrupter_lock.mp3","sounds/disrupter_lock.ogg"],obj:null},slide_out:{src:["sounds/disrupter_unlock.mp3","sounds/disrupter_unlock.ogg"],obj:null}},st=[rt+"texture/envmap3.png",rt+"texture/envmap3.png",rt+"texture/envmap.png",rt+"texture/envmap2.png",rt+"texture/envmap3.png",rt+"texture/envmap3.png"],ct=[rt+"texture/envmap.png",rt+"texture/envmap.png",rt+"texture/envmap.png",rt+"texture/envmap.png",rt+"texture/envmap.png",rt+"texture/envmap.png"],pt=THREE.ImageUtils.loadTextureCube(st);pt.minFilter=THREE.LinearFilter;var mt=THREE.ImageUtils.loadTextureCube(ct);mt.minFilter=THREE.LinearFilter;var ut=1,dt=1,Et={width:830,height:500,container:null},bt=[],ht=[],wt={blue_battery:{color:23483,shininess:30,specular:37871,metal:!0,side:THREE.DoubleSide},whiteblue_battery:{color:7527636,shininess:30,specular:9557981,metal:!0,side:THREE.DoubleSide},aquamarine_battery:{color:7527636,shininess:30,specular:9557981,metal:!0,side:THREE.DoubleSide},red_battery:{color:13178170,shininess:30,specular:15353456,metal:!0,side:THREE.DoubleSide},pink_battery:{color:14098309,shininess:30,specular:16406715,metal:!0,side:THREE.DoubleSide},purple_battery:{color:11290546,shininess:30,specular:13131982,metal:!0,side:THREE.DoubleSide},green_battery:{color:39738,shininess:30,specular:4965011,metal:!0,side:THREE.DoubleSide},black_battery:{color:1118481,shininess:30,specular:3815743,metal:!0,side:THREE.DoubleSide},golden_material:{color:7627861,shininess:30,specular:14865862,metal:!0,side:THREE.DoubleSide},silver_material:{color:11778499,shininess:30,specular:14605286,metal:!0,side:THREE.DoubleSide},black_material:{color:1118481,shininess:30,specular:3815743,metal:!0,side:THREE.DoubleSide},grey_metal:{color:13421772,shininess:50,specular:12303291,metal:!0,side:THREE.DoubleSide},crome_metal:{color:13421772,shininess:100,specular:16777215,metal:!0,side:THREE.DoubleSide,envMap:mt,combine:THREE.MultiplyOperation,reflectivity:100},screws:{color:13421772,shininess:50,specular:11193565,metal:!0,side:THREE.DoubleSide},connectors:{color:10456915,shininess:50,specular:15392983,metal:!0,side:THREE.DoubleSide},texts:{color:6710886,shininess:50,specular:15392983,metal:!0,side:THREE.DoubleSide},logotexts:{color:16777215},black_plastic:{color:1118481,shininess:10,specular:15392983,metal:!1,side:THREE.DoubleSide},coil:{color:13421772,shininess:50,specular:11193565,metal:!0,side:THREE.DoubleSide},coil_glass:{color:16777215,shininess:10,specular:14540253,transparent:!0,opacity:.2,side:THREE.DoubleSide,depthWrite:!1},screen_transparent:{color:39168,shininess:10,specular:16711935,transparent:!0,opacity:.3,side:THREE.DoubleSide},defaultScreenBackground:{color:3354639,shininess:50,specular:2269376,metal:!0,side:THREE.DoubleSide},plastic_transparent:{color:16777215,specular:16777215,envMap:pt,combine:THREE.MultiplyOperation,transparent:!0,opacity:.4,reflectivity:30,shininess:80},plastic_powled:{color:16777215,specular:16777215,envMap:pt,combine:THREE.MultiplyOperation,transparent:!0,opacity:.9,reflectivity:5,shininess:40},plastic_black:{color:1118481,shininess:50,specular:16777215,side:THREE.DoubleSide},battery_bottom_text:{color:2236962,shininess:1,specular:3355443,metal:!0,side:THREE.DoubleSide}},yt=[wt.silver_material,wt.golden_material,wt.black_material],Tt=[wt.black_battery,wt.blue_battery,wt.pink_battery,wt.red_battery,wt.green_battery,wt.purple_battery,wt.whiteblue_battery],gt={disrupter:[{model:"obj/disrupter_shell_magnet.obj",type:"obj",name:"",material:wt.grey_metal},{model:"obj/disrupter_shell_magnet2.obj",type:"obj",name:"",material:wt.grey_metal},{model:"obj/upper_shell_lid.obj",type:"obj",name:"",material:wt.grey_metal},{model:"obj/upper_shell_lid_coil_socket.obj",type:"obj",name:"",material:wt.connectors},{model:"obj/disrupter_bottom.obj",type:"obj",name:"",material:wt.grey_metal},{model:"obj/connector_1.obj",type:"obj",name:"",material:wt.silver_material},{model:"obj/connector_2.obj",type:"obj",name:"",material:wt.connectors},{model:"obj/disrupter_screws.obj",type:"obj",name:"",material:wt.screws},{model:"obj/disrupter_bottom_screws.obj",type:"obj",name:"",material:wt.screws},{model:"obj/disrupter_ce_text.obj",type:"obj",name:"",material:wt.texts},{model:"obj/lcd_glass.obj",type:"obj",name:"",material:wt.screen_transparent},{model:"obj/power_button_led_ring.obj",type:"obj",name:"power_led",material:wt.plastic_black},{model:"obj/disrupter_shell.obj",type:"obj",name:"mod_shell",material:yt[0]},{model:"obj/power_button.obj",type:"obj",name:"startbutton",material:wt.silver_material},{model:"obj/up_button.obj",type:"obj",name:"up_button",material:wt.silver_material},{model:"obj/down_button.obj",type:"obj",name:"down_button",material:wt.silver_material},{model:"obj/olcd.dae",type:"collada",name:"olcd",material:wt.defaultScreenBackground},{model:"obj/screen_frame.obj",type:"obj",name:"olcd_frame",material:wt.silver_material}],innocell:[{model:"obj/battery.obj",type:"obj",name:"",material:wt.black_battery},{model:"obj/battery_2.obj",type:"obj",name:"",material:wt.black_battery},{model:"obj/battery_usb.obj",type:"obj",name:"",material:wt.grey_metal},{model:"obj/battery_upper_lid.obj",type:"obj",name:"",material:wt.grey_metal},{model:"obj/battery_bottom.obj",type:"obj",name:"",material:wt.grey_metal},{model:"obj/innocell_text.obj",type:"obj",name:"",material:wt.logotexts},{model:"obj/battery_srews.obj",type:"obj",name:"",material:wt.screws},{model:"obj/battery_lid_screws.obj",type:"obj",name:"",material:wt.screws},{model:"obj/battery_bottom_screws.obj",type:"obj",name:"",material:wt.screws},{model:"obj/battery_bottom_text.obj",type:"obj",name:"",material:wt.battery_bottom_text},{model:"obj/battery_shell.obj",type:"obj",name:"battery_shell",material:Tt[0]}],isub_coil02ohm:[{model:"obj/coil2.obj",type:"obj",name:"",material:wt.crome_metal},{model:"obj/coil2_glass.obj",type:"obj",name:"coil_glass",material:wt.coil_glass},{model:"obj/logo_sipca.obj",type:"obj",name:"coil_logo",material:wt.plastic_black}],tabletop:[{model:"obj/carousel_top.obj",type:"obj",name:"carousel",material:wt.plastic_transparent},{model:"obj/carousel_bottom.obj",type:"obj",name:"carousel",material:wt.black_material}]},vt=new THREE.Vector3,ft=["0.5","2.0"],_t={1:{title:"Choose Your Disrupter!",choose:"disrupter",clones:[]},2:{title:"Choose Your InnokinCell!",choose:"innocell",clones:[]},3:{title:"Choose your iSub Coil",choose:"isub_coil",clones:[],instructions:{ohms:{.5:"0.5Î© : Big Clouds","2.0":"2.0Î© Intense Flavors"}}},4:{title:"VAPE!",icon:"setp4-logo"}},xt={title:void 0,wrapper:void 0},Dt={ohmz:5,volt:0,watt:120,battery:1e3},jt="OFF",Nt="watt",Ht=0,Rt=0,Ft=null,St=null,Ct=!1,Mt=1500,Pt=null,zt=null;window.requestAnimationFrame=function(){return window.requestAnimationFrame||window.mozRequestAnimationFrame||window.webkitRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||function(e){return window.setTimeout(function(){e(new Date)},1e3/60)}}(),window.cancelAnimationFrame=window.cancelAnimationFrame||window.mozCancelAnimationFrame||window.webkitCancelAnimationFrame||function(e){clearTimeout(e)};var Wt={popout_object:function(e,t){new TWEEN.Tween(e.position).to({y:t},50).start()},coil_fadein:function(){et.isub_coil02ohm.rotation.set(0,0,0),et.isub_coil02ohm.position.set(0,0,0),et.isub_coil02ohm.traverse(function(e){e instanceof THREE.Mesh&&new TWEEN.Tween(e.material).to({opacity:"coil_glass"==e.parent.name?wt.coil_glass.opacity:1},300).start()})},coil_fadeout:function(){et.isub_coil02ohm.rotation.set(0,0,0),et.isub_coil02ohm.position.set(0,0,0),et.isub_coil02ohm.traverse(function(e){e instanceof THREE.Mesh&&(e.material.transparent=!0,new TWEEN.Tween(e.material).to({opacity:0},300).start())})},explode_disrupter:function(){E(),et.innocell.position.x=-30,new TWEEN.Tween(et.innocell.position).to({x:0},300).start(),new TWEEN.Tween(et.isub_coil02ohm.position).to({y:30},300).start()},implode_disrupter:function(){E(),et.isub_coil02ohm.position.y=30,new TWEEN.Tween(et.innocell.position).to({x:-30},300).start(),new TWEEN.Tween(et.isub_coil02ohm.position).to({y:0},300).start()},change_battery:function(){E(),et.innocell.position.x=-30;var e=new TWEEN.Tween(et.innocell.position).to({y:400},500),t=new TWEEN.Tween(et.innocell.position).to({y:0},500);e.chain(t),e.start()},zoom_to_oled_new:function(){new TWEEN.Tween(J.rotation).to({z:-Math.PI/2,x:Math.PI/2},800).start();new TWEEN.Tween(J.position).to({x:-60,z:-10,y:30},800).start(),new TWEEN.Tween(B.position).to({x:-13.676161925598056,y:63.9452391807378,z:87.23723124674612},900).start(),new TWEEN.Tween(B.rotation).to({x:-.22118710812447032,y:-.015007889761138695,z:-.003374627986400691},900).start();var e=new TWEEN.Tween(K.center).to({x:-11.891589041561836,y:37.85999917667022,z:-28.76614107973018},900);e.onComplete(function(){K.update()}),e.start()},zoom_to_fullview:function(){{var e=1.3;new TWEEN.Tween(J.rotation).to({z:0,x:0,y:0},800).start()}new TWEEN.Tween(J.position).to({x:0,z:0,y:0},800).start(),new TWEEN.Tween(B.position).to({x:-144.20119763765334*e,y:111.2972966087502*e,z:121.55749190834881*e},900).start(),new TWEEN.Tween(B.rotation).to({x:-.2854704053759189,y:-.8427679017865717,z:-.2156764559473396},900).start();var t=new TWEEN.Tween(K.center).to({x:11.859650548162842*e,y:72.12312221743433*e,z:-11.921155841890096*e},900);t.onComplete(function(){K.update()}),t.start()},step:{1:{"in":function(e){for(var t=800/_t[1].clones.length,o=_t[1].clones.length-1,n=0;n<_t[1].clones.length;n++){_t[1].clones[n].position.y=400,_t[1].clones[n].rotation.y=0,new TWEEN.Tween(_t[1].clones[n].rotation).to({y:Math.PI/4},t).delay(n*t).start();var a=new TWEEN.Tween(_t[1].clones[n].position).to({y:0},t).delay(n*t);"function"==typeof e&&o==n&&a.onComplete(e),a.start()}new TWEEN.Tween(B.position).to({x:7.4252,y:84.2356,z:163.364},800).start(),new TWEEN.Tween(B.rotation).to({x:-.1473,y:.04493,z:.00666},800).start();var i=new TWEEN.Tween(K.center).to({x:0,y:60,z:0},800);i.onComplete(function(){K.update()}),i.start()},out:function(e){var t=1e3/_t[1].clones.length,o=(_t[1].clones.length-1,_t[1].clones.indexOf(tt.disrupter)),n=_t[1].clones.slice(0),a=0;for(o>-1&&(new TWEEN.Tween(_t[1].clones[o].rotation).to({y:0},t).start(),new TWEEN.Tween(_t[1].clones[o].position).to({y:400},t).start(),n.splice(o,1),a=1);n.length;){var i=n.shift();new TWEEN.Tween(i.rotation).to({y:0},t).delay(a*t).start();var r=new TWEEN.Tween(i.position).to({y:400},t).delay(a*t);a++,"function"!=typeof e||n.length||r.onComplete(e),r.start()}}},2:{"in":function(e){var t=.8,o=1500,n=new TWEEN.Tween(et.tabletop.rotation).to({y:et.tabletop.rotation.y-2*Math.PI},o);"function"==typeof e&&n.onComplete(e),n.start();for(var a=o/_t[2].clones.length,i=0;i<_t[2].clones.length;i++)_t[2].clones[i].position.y=300,new TWEEN.Tween(_t[2].clones[i].position).to({y:21},a).delay(i*a).start();new TWEEN.Tween(B.position).to({x:2.13455*t,y:178.7043*t,z:281.966*t},o).start(),new TWEEN.Tween(B.rotation).to({x:-.39847,y:.006977,z:.00293723},o).start();var r=new TWEEN.Tween(K.center).to({x:0*t,y:60*t,z:0*t},o);r.onComplete(function(){K.update()}),r.start()},out:function(e){var t=1500,o=new TWEEN.Tween(et.tabletop.rotation).to({y:et.tabletop.rotation.y+2*Math.PI},t);"function"==typeof e&&o.onComplete(e),o.start();var n=t/_t[2].clones.length,a=(_t[2].clones.length,_t[2].clones.indexOf(tt.innocell));a=-1!=a?a:_t[2].clones.length-1;for(var i=a,r=0;i>=0;i--,r++)_t[2].clones[i].position.y=21,new TWEEN.Tween(_t[2].clones[i].position).to({y:300},n).delay(r*n).start();for(var i=_t[2].clones.length-1;i>a;i--,r++)_t[2].clones[i].position.y=21,new TWEEN.Tween(_t[2].clones[i].position).to({y:300},n).delay(r*n).start()}},3:{"in":function(e){for(var t=800/_t[1].clones.length,o=_t[3].clones.length-1,n=0;n<_t[3].clones.length;n++){_t[3].clones[n].position.y=300;var a=new TWEEN.Tween(_t[3].clones[n].position).to({y:0},t).delay(n*t);"function"==typeof e&&o==n&&a.onComplete(e),a.start()}new TWEEN.Tween(B.position).to({x:7.44418,y:161.250269,z:147.11240281},400).start(),new TWEEN.Tween(B.rotation).to({x:-.225372,y:-.005534,z:-.00127},400).start();var i=new TWEEN.Tween(K.center).to({x:8.4538,y:120.4814,z:-30.71046},400);i.onComplete(function(){K.update()}),i.start()},out:function(e){var t=800/_t[3].clones.length,o=_t[3].clones.indexOf(tt.coil),n=_t[3].clones.slice(0),a=0;for(o>-1&&(new TWEEN.Tween(n[o].position).to({y:300},t).start(),n.splice(o,1),a=1);n.length;){var i=n.shift(),r=new TWEEN.Tween(i.position).to({y:300},t).delay(a*t);a++,"function"!=typeof e||n.length||r.onComplete(e),r.start()}}},4:{"in":function(){E(),J.rotation.set(0,0,0),J.position.set(0,0,0),et.disrupter.position.x=-400;var e=new TWEEN.Tween(et.disrupter.position).to({x:0},300);et.isub_coil02ohm.position.y=250;var t=new TWEEN.Tween(et.isub_coil02ohm.position).to({y:0},300);et.innocell.position.x=-30,et.innocell.position.y=400;var o=new TWEEN.Tween(et.innocell.position).to({y:100},300);o.onComplete(function(){try{lt.slide_in.obj.play()}catch(e){}});var n=new TWEEN.Tween(et.innocell.position).to({y:0},100);n.onComplete(function(){Wt.zoom_to_oled_new()}),e.chain(t),o.chain(n),t.chain(o),e.start(),new TWEEN.Tween(B.position).to({x:-133.1346,y:108.2085,z:207.3575},900).start(),new TWEEN.Tween(B.rotation).to({x:-.13705,y:-.58042,z:-.0755},900).start();var a=new TWEEN.Tween(K.center).to({x:21.723,y:75.946,z:-26.5752},900);a.onComplete(function(){K.update()}),a.start()},out:function(e){E();var t=new TWEEN.Tween(J.rotation).to({z:0,x:0,y:0},800);new TWEEN.Tween(J.position).to({x:0,z:0,y:0},800).start(),t.onComplete(function(){try{lt.slide_out.obj.play()}catch(t){}var o=new TWEEN.Tween(et.disrupter.position).to({x:-400},300),n=new TWEEN.Tween(et.isub_coil02ohm.position).to({y:250},300),a=new TWEEN.Tween(et.innocell.position).to({x:-30,y:400},300);a.chain(n),n.chain(o),"function"==typeof e&&o.onComplete(e);try{lt.slide_out.obj.play()}catch(t){}a.start()}),t.start(),new TWEEN.Tween(B.position).to({x:-133.1346,y:108.2085,z:207.3575},600).start(),new TWEEN.Tween(B.rotation).to({x:-.13705,y:-.58042,z:-.0755},600).start();var o=new TWEEN.Tween(K.center).to({x:21.723,y:75.946,z:-26.5752},600);o.onComplete(function(){K.update()}),o.start()}}}};this.getCamera=function(){console.log(B.position,B.rotation,K.center,K.target)},this.getRenderer=function(){return L},this.getScene=function(){return I},this.zoom_oled=function(){D()},this.zoom_full=function(){j()},this.Init=function(e){if(I)return!1;U=new THREE.Clock,l(e),I=new THREE.Scene,B=new THREE.PerspectiveCamera(50,Et.width/Et.height,1,800),B.position.z=300,B.position.y=60,L=new THREE.WebGLRenderer({antialias:!0,alpha:!0}),L.setSize(Et.width,Et.height),L.autoClear=!1,L.gammaInput=!0,L.gammaOutput=!0,L.shadowMapEnabled=!0,Et.container.appendChild(L.domElement),K=new THREE.OrbitControls(B,L.domElement),K.noPan=!0,K.noKeys=!0,K.minDistance=100,K.maxDistance=500,K.maxPolarAngle=Math.PI/2,K.minPolarAngle=Math.PI/3,K.panUp(60),K.update(),A();var t=.15,o=2,a=16777215,r=new THREE.DirectionalLight(a,t);
r.position.set(300*o,300*o,0*o),r.name="StaticLight1",I.add(r);var c=new THREE.DirectionalLight(a,t);c.position.set(0*o,300*o,300*o),c.name="StaticLight2",I.add(c);var p=new THREE.DirectionalLight(a,t);p.position.set(0*o,-300*o,300*o),p.name="StaticLight3",I.add(p);var m=new THREE.DirectionalLight(a,t);m.position.set(-300*o,300*o,0*o),m.name="StaticLight4",I.add(m);var u=new THREE.DirectionalLight(a,t);u.position.set(0*o,-300*o,-300*o),u.name="StaticLight5",I.add(u),Y=new THREE.PointLight(16777215,.1),Y.position.x=B.position.x,Y.position.y=B.position.y,Y.position.z=B.position.z,I.add(Y),_();try{for(var E in lt){lt[E].obj=document.createElement("audio");for(var b=0;b<lt[E].src.length;b++){var h=document.createElement("source"),w=lt[E].src[b].split(".");w=w[w.length-1],h.type="audio/"+w,h.src=rt+lt[E].src[b],lt[E].obj.appendChild(h)}lt[E].obj.load()}}catch(y){}d(),s(),i(),q=new THREE.Raycaster;for(var T=["mousedown","mouseup","mousemove","pointerdown","pointerup","pointermove","touchstart","touchend","touchmove"],g=0;g<T.length;g++)L.domElement.addEventListener(T[g],n);return!0},this.step=function(e){x(e)},this.start_smoke=function(){(jt="ON")&&N(Dt.watt)},this.stop_smoke=function(){H()},this.refresh_smoke=function(){Ct&&(H(),N(Dt.watt))},generalStartScreen=function(){console.log(I);var e=I.getObjectByName("smallScreen");e||(screenDynamicTexture=new THREEx.DynamicTexture(400,200),screenDynamicTexture.texture.anisotropy=L.getMaxAnisotropy(),planeGeometry1=new THREE.PlaneBufferGeometry(45,20,30,30),planeMaterial=new THREE.MeshBasicMaterial({map:screenDynamicTexture.texture}),ScreenPlane=new THREE.Mesh(planeGeometry1,planeMaterial),ScreenPlane.name="smallScreen",groupMecanism=I.getObjectByName("disrupter"),groupMecanism&&(console.log("THERE IS A GRUPMECANISM"),groupMecanism.add(ScreenPlane)),ScreenPlane.position.x=-32.8,ScreenPlane.position.x=-32.8,ScreenPlane.position.z=-3.5,ScreenPlane.position.y=26.5,ScreenPlane.rotation.z=Math.PI/2,ScreenPlane.rotation.y=-Math.PI/2,screenDynamicTexture.texture.needsUpdate=!0,screenDynamicTexture.clear("#667788"),ScreenPlane.scale.x=.5,ScreenPlane.scale.y=.5,ScreenPlane.scale.z=.5)},delayStopScreen=function(e){var t=I.getObjectByName("smallScreen");t&&setTimeout(function(){groupMecanism=I.getObjectByName("disrupter"),groupMecanism.remove(ScreenPlane)},e)},instantStopScreen=function(){var e=I.getObjectByName("smallScreen");e&&setTimeout(function(){groupMecanism=I.getObjectByName("disrupter"),groupMecanism.remove(ScreenPlane)},0)},this.startDisruptorWithLogo=function(){generalStartScreen(),screenDynamicTexture.drawText("î",25,130,"#FDFDFD","114px DisrupterLCDFont"),screenDynamicTexture.drawText("innokin",170,90,"#FDFDFD","38px DisrupterLCDFont"),screenDynamicTexture.drawText("technology",145,130,"#FDFDFD","38px DisrupterLCDFont"),setTimeout(function(){screenDynamicTexture.clear("#667788"),displayDisruptor()},1500)},displayDisruptor=function(){generalStartScreen(),R(screenDynamicTexture,"watt")},this.displayStartInformation=function(){generalStartScreen(),screenDynamicTexture.drawText("OFF",150,90,"#FDFDFD","51.2px DisrupterLCDFont"),screenDynamicTexture.drawText("click 3x on",45,145,"#FDFDFD","51.2px DisrupterLCDFont"),delayStopScreen(1e3)}},InnokinDisrupterViewer=new _InnokinDisrupterViewer;